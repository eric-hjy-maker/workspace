###### vidio_url:https://www.bilibili.com/video/BV1kd4y1m75U/?spm_id_from=333.337.search-card.all.click&vd_source=b60fb1a1a8f06e334bf9ca2665cdd202

# 分布式锁
##### redis 实现分布式锁
    setnx k v, 执行完删除 即可
##### redis 如何防止别的机器删除自己的锁？
    情景：自己设置超时时间过了，还没执行完，别的机器加了锁，自己执行删除锁，把别的锁删了
    判断设置的 v，如果是自己设置的 v，才删除
##### redis 业务代码执行时间超过过期时间，自己的锁失效，别的锁就加上了不应该加的锁
    Redission 就有看门狗机制，每隔 10s 给这个锁续命 30s，直到执行完，删除锁
##### redis 分布式锁优化
    减小锁的粒度，锁更少的代码
    参考 ConcurrentHashMap, 对数据分段加锁
    
